## 第1部分：建立认知（What & Why）

### 📦 1.1 四大安全等级 *💡 核心必学*

Java 提供了 4 种权限控制。请务必记住这个 **"权限倒金字塔"**（从严到宽）：

1. **`private` (私有)**：🚫 **只有我自己能看**。
   * 范围：**本类内部**。
   * 比喻：你的**日记本**，或者是银行的**金库核心区**。

2. **`default` (默认/包级私有)**：🤝 **我和邻居能看**。
   * 范围：**本类 + 同一个包 (Package)**。
   * **注意**：如果你**什么都不写**，就是这个级别（也叫 package-private）。
   * 比喻：**部门内部群**，只有同一个部门（包）的同事能进。

3. **`protected` (受保护)**：👨‍👧‍👦 **我和孩子+邻居能看**。
   * 范围：**本类 + 同包 + 不同包的子类**。
   * 比喻：**家族信托基金**。外人不行，但你的孩子（子类）即便搬到国外（不同包）也能用。

4. **`public` (公开)**：🌍 **全世界都能看**。
   * 范围：**整个项目**。
   * 比喻：**银行大门**，谁都能进来。

    
### 📊 1.2 权限对照表

这是必须印在脑子里的表格：

| 修饰符 | 本类 (Class) | 同包 (Package) | 子类 (Subclass) | 世界 (World) |
| --- | --- | --- | --- | --- |
| **private** | ✅ | ❌ | ❌ | ❌ |
| **(default)** | ✅ | ✅ | ❌ | ❌ |
| **protected** | ✅ | ✅ | ✅ | ❌ |
| **public** | ✅ | ✅ | ✅ | ✅ |

---

## 第2部分：工程实践（How to Do Right）

在真实的工程开发中，怎么选择修饰符？这里有一条黄金法则：

> **🛡️ 最小权限原则 (Principle of Least Privilege)**
> **默认全用 `private`，除非你有非常充分的理由公开它。**

### ✅ 2.1 什么时候用什么？

* **成员变量 (Fields)**：**99% 的情况必须是 `private`。**
  * 绝对禁止 `public` 字段（除了 `static final` 常量）。
  * 如果要给别人用，请提供 `public` 的 `get/set` 方法。

* **构造器 (Constructors)**：
  * 通常是 `public`。
  * 如果是工具类或单例模式，用 `private`。

* **方法 (Methods)**：
  * **Public**：你想暴露给外部调用的 API。
  * **Private**：类内部的辅助逻辑（Helper methods），不想让别人知道细节。

    
### 🌍 2.2 真实场景演示

**场景**：设计一个 `BankAccount`（银行账户）。

```java
package com.bank.core;

public class BankAccount {
    // 🔴 1. 核心数据必须私有 (private)
    // 防止外部直接 user.balance = -10000;
    private double balance;
    
    // 🔴 2. 辅助密码算法私有 (private)
    // 这种底层实现细节，不要暴露给外部
    private String encryptPassword(String pwd) {
        return "Encrypted_" + pwd;
    }

    // 🟢 3. 对外业务接口公开 (public)
    // 外部通过这个"窗口"来操作，我们可以在这里做安全检查
    public void deposit(double amount) {
        if (amount > 0) {
            this.balance += amount;
        }
    }

    // 🟠 4. 给子类开后门 (protected)
    // 允许 VIP账号 (子类) 哪怕在不同包也能访问某些特权信息
    protected void triggerVipEvent() {
        System.out.println("VIP 事件触发");
    }
}

```

---

## 第3部分：避坑进阶（What to Avoid）

### ⚠️ 3.1 最大的误区：Protected

**陷阱**：很多初学者以为 `protected` **只**给子类用。
**真相**：`protected` = 子类 + **同包 (Package)**。

这意味着，只要和你同一个包的类（哪怕不是你儿子），也能访问你的 `protected` 成员。

* **后果**：如果你把代码分模块分得不好，`protected` 可能会导致意想不到的权限泄露。

### ⚠️ 3.2 类本身的修饰符

上面讲的都是成员（变量/方法）。**对于"类"本身**，只有两个选择：

1. **`public class User`**：其他包也能用这个类。
   * *约束：文件名必须和类名一致。*

2. **`class User` (default)**：只有同一个包能用这个类。
   * *场景：作为某个大功能模块内部的隐藏实现类，不想让外面的模块看到。*



**❌ 错误写法**：

    ```java
    // 编译错误！类不能是 private 或 protected (内部类除外)
    private class User { } 
    
    ```

### 🚀 3.3 为什么不要用 Default？

在现代 Java 开发中，**(default)** 权限其实用得很少。

* **原因**：它通常意味着你的包结构设计得比较紧密。但在大型项目中，往往要么是私有的 (`private`)，要么是公开的 API (`public`)，中间态反而容易造成混乱。
* **建议**：当你犹豫不决时，先写 `private`，如果编译器报错说"访问不到"，再考虑改成 `protected` 或 `public`。

一定要把 **"最小权限原则"** 刻在心里：**严防死守，按需开放**。

