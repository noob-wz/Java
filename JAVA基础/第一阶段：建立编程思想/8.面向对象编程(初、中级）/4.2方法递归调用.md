## ç¬¬1éƒ¨åˆ†ï¼šå»ºç«‹è®¤çŸ¥ï¼ˆWhat & Whyï¼‰

### ğŸ“¦ 1.1 æ ¸å¿ƒè¯­æ³• *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šç†è§£é€’å½’çš„â€œä¸¤è¦ç´ â€â€”â€”**ç»ˆæ­¢æ¡ä»¶**ä¸**è‡ªæˆ‘è°ƒç”¨**ã€‚

é€’å½’æ–¹æ³•æœ¬è´¨ä¸Šå°±æ˜¯**è‡ªå·±è°ƒç”¨è‡ªå·±**çš„æ–¹æ³•ã€‚

**åŸºç¡€è¯­æ³•ç»“æ„**ï¼š

```java
/**
 * é€’å½’çš„æ ‡å‡†ç»“æ„
 * å¿…é¡»åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¦åˆ™å°±æ˜¯æ­»å¾ªç¯
 */
public void recursiveMethod(int n) {
    // 1. ğŸ›‘ ç»ˆæ­¢æ¡ä»¶ (Base Case)
    // å¦‚æœæ²¡æœ‰è¿™ä¸ªï¼Œæˆ–è€…æ¡ä»¶æ°¸è¿œæ— æ³•æ»¡è¶³ï¼Œç¨‹åºä¼šå´©æºƒ (StackOverflowError)
    if (n <= 0) {
        return; 
    }

    // 2. ğŸŒ€ é€’å½’é€»è¾‘ (Recursive Step)
    // è¿™é‡Œå¤„ç†å½“å‰å±‚çº§çš„é€»è¾‘ï¼Œå¹¶è°ƒç”¨è‡ªå·±è¿›å…¥ä¸‹ä¸€å±‚
    // æ³¨æ„ï¼šå‚æ•°å¿…é¡»å‘â€œç»ˆæ­¢æ¡ä»¶â€é è¿‘ (n - 1)
    System.out.println("å½“å‰å¤„ç†: " + n);
    recursiveMethod(n - 1);
}

```

**è¯­æ³•é“å¾‹**ï¼š

1. **å¿…é¡»æœ‰å‡ºå£**ï¼šæ‰€æœ‰é€’å½’å¿…é¡»æœ‰ä¸€ä¸ªæ˜ç¡®çš„ `if` åˆ¤æ–­æ¥ç»“æŸè°ƒç”¨ã€‚
2. **å¿…é¡»è¶‹è¿‘å‡ºå£**ï¼šæ¯æ¬¡é€’å½’è°ƒç”¨çš„å‚æ•°å˜åŒ–ï¼Œå¿…é¡»è®©çŠ¶æ€ç¦»å‡ºå£æ›´è¿‘ä¸€æ­¥ã€‚

---

### ğŸ”— 1.2 å…³è”æ¦‚å¿µ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šç†è§£æ”¯æ’‘é€’å½’è¿è¡Œçš„å¹•åæœºåˆ¶ã€‚

1. **æ–¹æ³•æ ˆå¸§ (Stack Frame)**ï¼š
   * **å®šä¹‰**ï¼šæ¯æ¬¡æ–¹æ³•è°ƒç”¨ï¼ŒJVM éƒ½ä¼šåœ¨å†…å­˜çš„â€œæ ˆ (Stack)â€åŒºåŸŸåˆ›å»ºä¸€ä¸ªæ–°çš„â€œæ ˆå¸§â€ã€‚
   * **ä½œç”¨**ï¼šå­˜å‚¨è¯¥æ¬¡è°ƒç”¨çš„å±€éƒ¨å˜é‡ã€å‚æ•°å’Œè¿”å›åœ°å€ã€‚
   * **å…³é”®ç‚¹**ï¼šé€’å½’è°ƒç”¨ N æ¬¡ï¼Œå°±ä¼šäº§ç”Ÿ N ä¸ªæ ˆå¸§ï¼Œå®ƒä»¬åƒç›˜å­ä¸€æ ·å åœ¨ä¸€èµ·ï¼Œäº’ä¸å¹²æ‰°ã€‚


2. **åè¿›å…ˆå‡º (LIFO)**ï¼š
   * **è¡Œä¸º**ï¼šæœ€åè°ƒç”¨çš„æ–¹æ³•ï¼ˆæœ€æ·±çš„é‚£ä¸€å±‚ï¼‰ï¼Œæœ€å…ˆæ‰§è¡Œå®Œå¹¶è¿”å›ã€‚
   * **å½±å“**ï¼šæ•°æ®çš„å¤„ç†é¡ºåºå¾€å¾€æ˜¯â€œå½’â€çš„æ—¶å€™æ‰çœŸæ­£å®Œæˆè®¡ç®—ã€‚



**ä»£ç éªŒè¯**ï¼š

```java
public void printConcept(int n) {
    // æ¦‚å¿µä¾èµ–ï¼šæ–¹æ³•æ ˆå¸§ (Stack Frame)
    // æ¯ä¸€å±‚ n çš„å€¼éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå­˜åœ¨äºä¸åŒçš„æ ˆå¸§ä¸­
    if (n == 0) return;
    
    System.out.println("å»ç¨‹ (Push): " + n); // é€’ï¼šå…¥æ ˆè¿‡ç¨‹
    printConcept(n - 1);
    System.out.println("å›ç¨‹ (Pop): " + n);  // å½’ï¼šå‡ºæ ˆè¿‡ç¨‹
}

```

---

### ğŸš€ 1.3 å¿«é€Ÿä¸Šæ‰‹ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šå†™ä¸€ä¸ªè®¡ç®— 1 åˆ° N ç´¯åŠ å’Œçš„ç¨‹åºï¼Œä½“éªŒâ€œé€’â€ä¸â€œå½’â€ã€‚

```java
public class RecursionDemo {

    public static void main(String[] args) {
        int n = 5;
        int result = sum(n);
        System.out.println("1åˆ°" + n + "çš„ç´¯åŠ å’Œæ˜¯: " + result);
    }

    /**
     * è®¡ç®— 1 + 2 + ... + n
     * é€»è¾‘ï¼šsum(n) = n + sum(n-1)
     */
    public static int sum(int n) {
        // 1. ç»ˆæ­¢æ¡ä»¶ï¼šåŠ åˆ° 1 ä¸ºæ­¢
        if (n == 1) {
            return 1; // æ­¤æ—¶ä¸å†è°ƒç”¨è‡ªå·±ï¼Œå¼€å§‹â€œå½’â€
        }

        // 2. é€’å½’è°ƒç”¨
        // å‡è®¾ sum(n-1) èƒ½ç®—å‡ºåé¢çš„å’Œï¼Œæˆ‘ä»¬åªéœ€è¦åŠ ä¸Šå½“å‰çš„ n
        return n + sum(n - 1); 
    }
}

```

**è¿è¡Œç»“æœ**ï¼š

```text
1åˆ°5çš„ç´¯åŠ å’Œæ˜¯: 15

```

---

### ğŸ’¡ 1.4 å®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šç†è§£ä¸ºä»€ä¹ˆä¸ç”¨å¾ªç¯ (Loop) è€Œç”¨é€’å½’ã€‚

**åœºæ™¯å¯¹æ¯”ï¼šæ–‡ä»¶ç›®å½•éå†**     
å‡è®¾æˆ‘ä»¬è¦æ‰¾å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰çš„ `.java` æ–‡ä»¶ï¼ˆæ–‡ä»¶å¤¹é‡Œå¯èƒ½è¿˜æœ‰æ–‡ä»¶å¤¹ï¼Œå±‚çº§æœªçŸ¥ï¼‰ã€‚

**âŒ å¦‚æœç”¨å¾ªç¯ (Iteration)**ï¼š        
ä½ éœ€è¦ç»´æŠ¤ä¸€ä¸ªå¤æ‚çš„è¾…åŠ©æ ˆæˆ–é˜Ÿåˆ—ï¼Œä»£ç é€»è¾‘éçº¿æ€§ï¼Œéå¸¸éš¾è¯»ã€‚

**âœ… å¦‚æœç”¨é€’å½’ (Recursion)**ï¼š        
é€»è¾‘ç¬¦åˆäººç±»ç›´è§‰ï¼šå¤„ç†å½“å‰æ–‡ä»¶å¤¹ -> å¦‚æœé‡åˆ°å­æ–‡ä»¶å¤¹ï¼Œå¯¹å­æ–‡ä»¶å¤¹åšåŒæ ·çš„äº‹ã€‚

```java
// ä¼ªä»£ç å¯¹æ¯”
// é€’å½’å†™æ³•ï¼šæ¸…æ™°è‡ªç„¶
void findFiles(Directory dir) {
    for (File f : dir.files) {
        if (f.isDir()) {
            findFiles(f); // ç›´æ¥è°ƒç”¨è‡ªå·±ï¼Œå¤„ç†å­æ–‡ä»¶å¤¹
        } else {
            print(f);
        }
    }
}

```

**è®¾è®¡æ”¶ç›Š**ï¼š

* **è·å¾—**ï¼šæä½³çš„ä»£ç å¯è¯»æ€§ï¼Œå¤„ç†æ ‘å½¢/å›¾çŠ¶ç»“æ„ï¼ˆå¦‚èœå•ã€æ–‡ä»¶ç³»ç»Ÿã€JSONè§£æï¼‰çš„ç¥å™¨ã€‚
* **ç‰ºç‰²**ï¼šç©ºé—´å¤æ‚åº¦ï¼ˆæ¶ˆè€—æ ˆå†…å­˜ï¼‰ï¼Œå¦‚æœä¸åŠ æ§åˆ¶å¯èƒ½å¯¼è‡´æ ˆæº¢å‡ºã€‚

---

### âš™ï¸ 1.5 åº•å±‚åŸç† *â­ è¿›é˜¶é€‰å­¦*

**ç›®æ ‡**ï¼šå¯è§†åŒ– JVM æ ˆå†…å­˜çš„åŠ¨æ€å˜åŒ–ã€‚

å½“æˆ‘ä»¬è°ƒç”¨ `sum(3)` æ—¶ï¼Œå†…å­˜ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

**æ‰§è¡Œæµç¨‹ä¸å†…å­˜æ¨¡å‹ (ASCII å›¾)**ï¼š

```text
é˜¶æ®µ A: é€’ (Drill Down) - ç–¯ç‹‚å‹æ ˆ
Stack Memory (æ ˆå†…å­˜)
+-------------------------+
| sum(1) | n=1 | return 1 | <--- é¡¶å±‚ (è§¦å‘ç»ˆæ­¢æ¡ä»¶)
+-------------------------+
| sum(2) | n=2 | ç­‰å¾…sum(1)|
+-------------------------+
| sum(3) | n=3 | ç­‰å¾…sum(2)|
+-------------------------+
| main()                  | <--- åº•å±‚
+-------------------------+

      |  (å¼€å§‹è¿”å› return)
      v

é˜¶æ®µ B: å½’ (Bubble Up) - ä¾æ¬¡å‡ºæ ˆè®¡ç®—
1. sum(1) è¿”å› 1ï¼Œå¼¹å‡ºã€‚
2. sum(2) æ”¶åˆ° 1ï¼Œè®¡ç®— 2 + 1 = 3ï¼Œè¿”å› 3ï¼Œå¼¹å‡ºã€‚
3. sum(3) æ”¶åˆ° 3ï¼Œè®¡ç®— 3 + 3 = 6ï¼Œè¿”å› 6ï¼Œå¼¹å‡ºã€‚
4. å›åˆ° main()ï¼Œæ‹¿åˆ°ç»“æœ 6ã€‚

```

**å…³é”®ç»“è®º**ï¼š
é€’å½’ä¸æ˜¯â€œé­”æ³•â€ï¼Œå®ƒåªæ˜¯åˆ©ç”¨äº† **Stack (æ ˆ)** è¿™ç§æ•°æ®ç»“æ„å¸®æˆ‘ä»¬ä¿å­˜äº†æ¯ä¸€æ¬¡è°ƒç”¨çš„çŠ¶æ€ï¼ˆå˜é‡ n çš„å€¼ï¼‰ã€‚

--- 

## ç¬¬2éƒ¨åˆ†ï¼šå·¥ç¨‹å®è·µï¼ˆHow to Do Rightï¼‰

### ğŸ” å‰ç½®çŸ¥è¯†æ£€æŸ¥

åœ¨æ·±å…¥å®æˆ˜å‰ï¼Œè¯·ç¡®ä¿ä½ è¿˜è®°å¾—ï¼š

1. **æ ˆå¸§ (Stack Frame)**ï¼šçŸ¥é“é€’å½’æ¯ä¸€æ¬¡è°ƒç”¨éƒ½ä¼šæ¶ˆè€—ä¸€ç‚¹æ ˆå†…å­˜ï¼ˆåœ¨1.5èŠ‚å­¦è¿‡ï¼‰ã€‚
2. **ç»ˆæ­¢æ¡ä»¶**ï¼šçŸ¥é“æ²¡æœ‰å‡ºå£çš„é€’å½’ä¼šå¯¼è‡´å´©æºƒï¼ˆåœ¨1.1èŠ‚å­¦è¿‡ï¼‰ã€‚

---

### ğŸŒ 2.1 çœŸå®åœºæ™¯ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šæŒæ¡é€’å½’åœ¨åç«¯å¼€å‘ä¸­æœ€é«˜é¢‘çš„åœºæ™¯â€”â€”**æ ‘å½¢ç»“æ„æ„å»º**ã€‚

**ä¸šåŠ¡åœºæ™¯ï¼šç”µå•†åå°ç±»ç›®æ ‘**        
åœ¨æ•°æ®åº“ä¸­ï¼Œåˆ†ç±»é€šå¸¸æ˜¯ä»¥â€œæ‰å¹³â€çš„æ–¹å¼å­˜å‚¨çš„ï¼ˆæ¯è¡Œè®°å½•å­˜ `id` å’Œ `parentId`ï¼‰ã€‚ä½†åœ¨å‰ç«¯é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦å±•ç¤ºæˆâ€œæ ‘çŠ¶â€èœå•ã€‚

**æ•°æ®æµè½¬**ï¼š

```text
æ•°æ®åº“ (Flat List)              å‰ç«¯/App (Tree Structure)
+----+-------+----------+      root
| id | name  | parentId |       â””â”€ ç”µå­äº§å“
+----+-------+----------+           â”œâ”€ æ‰‹æœº
| 1  | ç”µå­  | 0        | --->      â”‚   â””â”€ iPhone
| 2  | æ‰‹æœº  | 1        |           â””â”€ ç”µè„‘
| 3  | iPhone| 2        |               â””â”€ MacBook
+----+-------+----------+

```

**ä»£ç å®ç°**ï¼š

```java
import java.util.List;
import java.util.ArrayList;
import java.util.stream.Collectors;

// ä½¿ç”¨ Java 17 record å®šä¹‰æ•°æ®è½½ä½“ (ç®€æ´ã€ä¸å¯å˜)
// record æ˜¯ Java 14+ å¼•å…¥çš„ç‰¹æ€§ï¼Œè‡ªåŠ¨ç”Ÿæˆ getter/constructor/toString
public record Category(long id, String name, long parentId, List<Category> children) {
    // ä¸ºäº†æ–¹ä¾¿æ·»åŠ å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¯å˜çš„æ„é€ è¾…åŠ©ï¼ˆRecordçš„Listé€šå¸¸ä¸å¯å˜ï¼‰
    // ä½†ä¸ºäº†æ¼”ç¤ºç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬ç¨ä½œå˜é€šï¼Œå‡è®¾ children æ˜¯å¯å˜çš„ ArrayList
}

public class MenuBuilder {

    /**
     * ä¸šåŠ¡å…¥å£ï¼šå°†æ‰å¹³åˆ—è¡¨è½¬ä¸ºæ ‘å½¢ç»“æ„
     */
    public List<Category> buildTree(List<Category> allCategories) {
        // 1. æ‰¾åˆ°æ‰€æœ‰çš„æ ¹èŠ‚ç‚¹ (parentId == 0)
        List<Category> roots = allCategories.stream()
            .filter(c -> c.parentId() == 0)
            .collect(Collectors.toList());

        // 2. å¯¹æ¯ä¸ªæ ¹èŠ‚ç‚¹ï¼Œé€’å½’å¯»æ‰¾å®ƒçš„å­èŠ‚ç‚¹
        for (Category root : roots) {
            findChildren(root, allCategories);
        }
        
        return roots;
    }

    /**
     * é€’å½’æ–¹æ³•ï¼šå¡«å……å­èŠ‚ç‚¹
     * è¯­ä¹‰ï¼šç»™æˆ‘ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œæˆ‘å¸®ä½ åœ¨ allCategories é‡Œæ‰¾åˆ°å®ƒçš„æ‰€æœ‰å­å­å­™å­™
     */
    private void findChildren(Category parent, List<Category> allCategories) {
        // 1. ç­›é€‰å‡ºå½“å‰ parent çš„ç›´æ¥å­èŠ‚ç‚¹
        List<Category> directChildren = allCategories.stream()
            .filter(c -> c.parentId() == parent.id())
            .collect(Collectors.toList());

        // 2. å°†æ‰¾åˆ°çš„å­èŠ‚ç‚¹åŠ å…¥çˆ¶èŠ‚ç‚¹ (å‡è®¾ children åˆ—è¡¨å¯å˜)
        parent.children().addAll(directChildren);

        // 3. ğŸŒ€ é€’å½’è°ƒç”¨ï¼šå¯¹æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç»§ç»­æ‰¾å®ƒä»¬çš„å­èŠ‚ç‚¹
        // è¿™é‡Œæ²¡æœ‰æ˜¾å¼çš„ "if (xxx) return"ï¼Œå› ä¸ºå½“ directChildren ä¸ºç©ºæ—¶ï¼Œ
        // å¾ªç¯ä¸ä¼šæ‰§è¡Œï¼Œé€’å½’è‡ªç„¶åœæ­¢ï¼ˆè¿™æ˜¯éšå¼çš„ç»ˆæ­¢æ¡ä»¶ï¼‰
        for (Category child : directChildren) {
            findChildren(child, allCategories);
        }
    }
}

```

**ä½¿ç”¨æŒ‡å—**ï¼š

* **ä»€ä¹ˆæ—¶å€™ç”¨**ï¼šå¤„ç†èœå•ã€ç»„ç»‡æ¶æ„ã€è¯„è®ºç›–æ¥¼ï¼ˆå›å¤çš„å›å¤ï¼‰ã€æ–‡ä»¶ç›®å½•ã€‚
* **ä»€ä¹ˆæ—¶å€™ä¸ç”¨**ï¼šçº¿æ€§æ•°æ®å¤„ç†ï¼ˆç”¨å¾ªç¯ï¼‰ï¼Œæˆ–è€…æ ‘çš„æ·±åº¦ææ·±ï¼ˆè¶…è¿‡å‡ åƒå±‚ï¼Œä¼šæ ˆæº¢å‡ºï¼‰ã€‚

---

### âœ… 2.2 å·¥ç¨‹è§„èŒƒ *ğŸ”¥ å®æˆ˜å¿…å¤‡*

**ç›®æ ‡**ï¼šé˜²æ­¢é€’å½’å†™å‡ºâ€œå®šæ—¶ç‚¸å¼¹â€ã€‚

åŸºäº Java 17+ æ ‡å‡†çš„çº¢ç»¿ç¯åˆ†çº§ï¼š

**ğŸ”´ REDï¼ˆå¼ºåˆ¶è§„èŒƒï¼‰ï¼šé˜²æ­¢æ— é™é€’å½’**

* **éšæ‚£**ï¼šå¦‚æœæ•°æ®ä¸­æœ‰â€œç¯â€ï¼ˆAæ˜¯Bçš„çˆ¶ï¼ŒBåˆæ˜¯Açš„çˆ¶ï¼‰ï¼Œé€’å½’ä¼šæ­»å¾ªç¯ç›´åˆ°æ ˆæº¢å‡ºã€‚
* **åæœ**ï¼šç”Ÿäº§ç¯å¢ƒæœåŠ¡å´©æºƒ (`StackOverflowError`)ã€‚

```java
// âŒ é”™è¯¯ç¤ºèŒƒï¼šæ²¡æœ‰ä»»ä½•ä¿æŠ¤çš„é€’å½’
public void unsafeRecursion(Node node) {
    process(node);
    unsafeRecursion(node.next); // å¦‚æœ next æŒ‡å‘äº†ä¹‹å‰çš„èŠ‚ç‚¹ï¼Œå°±æ­»å¾ªç¯äº†
}

// âœ… æ­£ç¡®ç¤ºèŒƒï¼šæ·±åº¦é™åˆ¶å«å…µ (Depth Guard)
public void safeRecursion(Node node, int depth) {
    // å¼ºåˆ¶è§„çº¦ï¼šè¶…è¿‡ 1000 å±‚ç›´æ¥æŠ¥é”™ï¼Œé˜²æ­¢ç³»ç»Ÿå´©æºƒ
    if (depth > 1000) {
        throw new RuntimeException("é€’å½’è¿‡æ·±ï¼Œå¯èƒ½å­˜åœ¨å¾ªç¯å¼•ç”¨ï¼");
    }
    
    // æ­£å¸¸çš„ç»ˆæ­¢æ¡ä»¶
    if (node == null) return;

    process(node);
    safeRecursion(node.next, depth + 1); // æ¯æ¬¡é€’å½’ï¼Œæ·±åº¦+1
}

```

**ğŸŸ¢ GREENï¼ˆæ¨èé£æ ¼ï¼‰ï¼šå¿«é€Ÿå¤±è´¥ (Fail Fast)**

* **å»ºè®®**ï¼šå°†ç»ˆæ­¢æ¡ä»¶ï¼ˆBase Caseï¼‰æ”¾åœ¨æ–¹æ³•çš„æœ€é¡¶ç«¯ã€‚
* **å¥½å¤„**ï¼šä»£ç é€»è¾‘æ¸…æ™°ï¼Œå‡å°‘ä¸å¿…è¦çš„ç¼©è¿›ã€‚

```java
// âœ… æ¨èé£æ ¼
public void recursive(int n) {
    if (n <= 0) return; // å«å…µè¯­å¥ (Guard Clause)
    
    // æ ¸å¿ƒé€»è¾‘...
    recursive(n - 1);
}

```

---

### ğŸ”„ 2.3 ç‰ˆæœ¬æ¼”è¿› *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼šäº†è§£ Java å¯¹é€’å½’ä¼˜åŒ–çš„æ€åº¦ï¼ˆä»¥åŠä¸ºä»€ä¹ˆä½ éœ€è¦çŸ¥é“å®ƒï¼‰ã€‚

**ä¼ ç»Ÿå†™æ³• vs ç°ä»£è§‚ç‚¹**

| å¯¹æ¯”ç»´åº¦ | Java é€’å½’ç°çŠ¶ | ç°ä»£å‡½æ•°å¼è¯­è¨€ (Scala/Kotlin/Elixir) |
| --- | --- | --- |
| **å°¾è°ƒç”¨ä¼˜åŒ– (TCO)** | âŒ **ä¸æ”¯æŒ** | âœ… æ”¯æŒ (Tail Recursion Optimization) |
| **å«ä¹‰** | å³ä½¿ä½ æ˜¯å°¾é€’å½’ï¼ŒJVM ä¹Ÿä¼šç”Ÿæˆæ–°æ ˆå¸§ | ç¼–è¯‘å™¨ä¼šå°†å°¾é€’å½’ä¼˜åŒ–æˆ `while` å¾ªç¯ |
| **åæœ** | æ·±åº¦å¤§æ—¶å¿…æŒ‚ (`StackOverflow`) | ç†è®ºä¸Šå¯ä»¥æ— é™é€’å½’ |
| **å·¥ç¨‹å†³ç­–** | **æ·±åº¦æœªçŸ¥æˆ–å¾ˆå¤§æ—¶ï¼Œå¿…é¡»æ”¹å†™ä¸º `while` å¾ªç¯** | å¯ä»¥æ”¾å¿ƒä½¿ç”¨é€’å½’ |

**Java 8+ çš„æµå¼æ›¿ä»£**ï¼š
è™½ç„¶ Java ä¸æ”¯æŒ TCOï¼Œä½†åœ¨å¤„ç†ç®€å•é€’å½’ï¼ˆå¦‚ç´¯åŠ ã€è¿‡æ»¤ï¼‰æ—¶ï¼Œ`Stream` API æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚

```java
// ä¼ ç»Ÿé€’å½’ï¼šè®¡ç®— List ä¸­å­—ç¬¦ä¸²æ€»é•¿åº¦
public int recursiveLength(List<String> list, int index) {
    if (index == list.size()) return 0;
    return list.get(index).length() + recursiveLength(list, index + 1);
}

// ç°ä»£å†™æ³• (Java 8+)ï¼šStream
// æ›´åŠ å£°æ˜å¼ï¼Œä¸ç”¨æ‹…å¿ƒæ ˆæº¢å‡ºï¼ˆåº•å±‚æ˜¯è¿­ä»£ï¼‰
public int streamLength(List<String> list) {
    return list.stream()
        .mapToInt(String::length)
        .sum();
}

```

**ç»“è®º**ï¼š

* å¦‚æœæ˜¯**çº¿æ€§**é€»è¾‘ï¼ˆåˆ—è¡¨å¤„ç†ï¼‰ï¼šä¼˜å…ˆç”¨ **Stream** æˆ– **å¾ªç¯**ã€‚
* å¦‚æœæ˜¯**ç»“æ„åŒ–**é€»è¾‘ï¼ˆæ ‘/å›¾/åˆ†æ²»ç®—æ³•ï¼‰ï¼šä¼˜å…ˆç”¨ **é€’å½’**ï¼ˆä½†åœ¨2.2ä¸­è¦åŠ æ·±åº¦é™åˆ¶ï¼‰ã€‚

---

## ç¬¬3éƒ¨åˆ†ï¼šé¿å‘è¿›é˜¶ï¼ˆWhat to Avoid & Beyondï¼‰

### ğŸ” å‰ç½®çŸ¥è¯†æ£€æŸ¥

**åœ¨é˜¶æ®µ3å¼€å§‹å‰ï¼Œå¿…é¡»å›é¡¾ä»¥ä¸‹æ¦‚å¿µ**ï¼š

1. **æ ˆå¸§ (Stack Frame)**ï¼šé€’å½’ä¸ä»…æ¶ˆè€— CPUï¼Œè¿˜æ¶ˆè€—å†…å­˜ï¼ˆ1.2èŠ‚ï¼‰ã€‚
2. **æ—¶é—´å¤æ‚åº¦**ï¼šç†è§£  å’Œ  çš„å·¨å¤§å·®å¼‚ã€‚

---

### âš ï¸ 3.1 å¸¸è§é™·é˜±åˆé›† *ğŸ”¥ å®æˆ˜å¿…å¤‡*

**ç›®æ ‡**ï¼šè¯†åˆ«é€’å½’ä¸­çš„â€œæ€§èƒ½é»‘æ´â€â€”â€”**é‡å¤è®¡ç®—**ã€‚

#### é™·é˜± 1ï¼šæ–æ³¢é‚£å¥‘å™©æ¢¦ (The Fibonacci Nightmare)

**ğŸ“š æ¶‰åŠæ¦‚å¿µ**ï¼š**é‡å å­é—®é¢˜ (Overlapping Subproblems)**
è¿™æ˜¯æŒ‡é€’å½’è¿‡ç¨‹ä¸­ï¼Œç›¸åŒçš„å‚æ•°è¢«åå¤è®¡ç®—äº†å¤šæ¬¡ï¼Œæµªè´¹äº†å¤§é‡èµ„æºã€‚

**é”™è¯¯ä»£ç **ï¼š
è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ•™ç§‘ä¹¦å†™æ³•ï¼Œä½†åœ¨å·¥ç¨‹ä¸­æ˜¯**ç¾éš¾**ã€‚

```java
// âŒ é”™è¯¯ç¤ºèŒƒï¼šæä½æ•ˆçš„é€’å½’
// æ—¶é—´å¤æ‚åº¦ï¼šO(2^n) - æŒ‡æ•°çº§çˆ†ç‚¸
// æ¯”å¦‚ç®— fib(50)ï¼Œè¿™å°ç”µè„‘è·‘åˆ°æŠ¥åºŸéƒ½ç®—ä¸å‡ºæ¥
public long fib(int n) {
    if (n <= 1) return n;
    return fib(n - 1) + fib(n - 2);
}

```

**ä¸ºä»€ä¹ˆä¼šå‡ºé”™**ï¼š
è®©æˆ‘ä»¬çœ‹çœ‹è®¡ç®— `fib(5)` æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼š

```text
               fib(5)
             /        \
       fib(4)          fib(3)  <-- é‡å¤è®¡ç®—ï¼
       /    \          /    \
   fib(3)  fib(2)  fib(2)  fib(1)
   /    \
 ...    ...

```

**ASCII å›¾åˆ†æ**ï¼š

* `fib(3)` è¢«è®¡ç®—äº† 2 æ¬¡ã€‚
* `fib(2)` è¢«è®¡ç®—äº† 3 æ¬¡ã€‚
* å½“ n å¢å¤§æ—¶ï¼Œè®¡ç®—é‡å‘ˆæŒ‡æ•°çˆ†ç‚¸ã€‚

**âœ… ä¿®å¤æ–¹æ¡ˆï¼šè®°å¿†åŒ–æœç´¢ (Memoization)**

**åŸç†**ï¼šç”¨ä¸€ä¸ªâ€œå¤‡å¿˜å½•â€ï¼ˆMap æˆ– æ•°ç»„ï¼‰æŠŠç®—è¿‡çš„ç»“æœè®°ä¸‹æ¥ã€‚ä¸‹æ¬¡é‡åˆ°åŒæ ·çš„å‚æ•°ï¼Œç›´æ¥æŸ¥è¡¨ï¼Œä¸å†é€’å½’ã€‚

```java
import java.util.Map;
import java.util.HashMap;

public class Fibonacci {
    // ç¼“å­˜ï¼šé”®æ˜¯ nï¼Œå€¼æ˜¯ç»“æœ
    private static final Map<Integer, Long> cache = new HashMap<>();

    public long fib(int n) {
        if (n <= 1) return n;

        // 1. æŸ¥è¡¨ï¼šå¦‚æœç®—è¿‡äº†ï¼Œç›´æ¥è¿”å›
        if (cache.containsKey(n)) {
            return cache.get(n);
        }

        // 2. è®¡ç®—ï¼šæ ¸å¿ƒé€’å½’é€»è¾‘
        long result = fib(n - 1) + fib(n - 2);

        // 3. è®°å½•ï¼šå­˜å…¥ç¼“å­˜
        cache.put(n, result);
        
        return result;
    }
}

```

**ç°ä»£å†™æ³•ä¼˜åŒ– (Java 8+)**ï¼š

```java
// ä½¿ç”¨ computeIfAbsent ä¸€è¡Œæå®šæŸ¥è¡¨+è®¡ç®—+å­˜è¡¨
public long fibModern(int n) {
    if (n <= 1) return n;
    return cache.computeIfAbsent(n, key -> fibModern(key - 1) + fibModern(key - 2));
}

```

**æ”¶ç›Š**ï¼šæ—¶é—´å¤æ‚åº¦ä»  é™ä¸º ã€‚è®¡ç®— `fib(50)` åªéœ€è¦å‡ æ¯«ç§’ã€‚

---

### ğŸš€ 3.2 é«˜çº§æ¨¡å¼ *â­ è¿›é˜¶é€‰å­¦*

**ç›®æ ‡**ï¼šæŒæ¡é€’å½’çš„æ€æ‰‹é”â€”â€”**å›æº¯ç®—æ³• (Backtracking)**ã€‚

**é—®é¢˜åœºæ™¯**ï¼š
å¹¶ä¸æ˜¯æ‰€æœ‰é—®é¢˜éƒ½æ˜¯â€œä¸€æ¡è·¯èµ°åˆ°é»‘â€ï¼ˆå¦‚ç´¯åŠ ï¼‰ã€‚æœ‰äº›é—®é¢˜éœ€è¦â€œè¯•é”™â€ï¼š

* èµ°è¿·å®«ï¼šè¿™æ¡è·¯ä¸é€šï¼Ÿé€€å›å»æ¢æ¡è·¯èµ°ã€‚
* å…«çš‡åé—®é¢˜ / æ•°ç‹¬ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼š
**é€‰æ‹© (Choose) -> é€’å½’ (Recurse) -> æ’¤é”€ (Unchoose/Backtrack)**

**æ¨¡å¼å®ç°ï¼ˆç®€åŒ–ç‰ˆè·¯å¾„å¯»æ‰¾ï¼‰**ï¼š

```java
/**
 * åœºæ™¯ï¼šåœ¨ä¸€ä¸ªäºŒç»´ç½‘æ ¼ä¸­å¯»æ‰¾è·¯å¾„
 * grid[r][c] == 1 è¡¨ç¤ºå¢™ï¼Œ0 è¡¨ç¤ºè·¯
 */
public boolean findPath(int[][] grid, int r, int c) {
    // 1. è¶Šç•Œæ£€æŸ¥ æˆ– æ’å¢™ (Base Case: Failure)
    if (r < 0 || c < 0 || r >= grid.length || c >= grid[0].length || grid[r][c] == 1) {
        return false;
    }

    // 2. åˆ°è¾¾ç»ˆç‚¹ (Base Case: Success)
    if (r == grid.length - 1 && c == grid[0].length - 1) {
        return true;
    }

    // 3. æ ‡è®°å½“å‰ç‚¹å·²èµ°è¿‡ï¼ˆé˜²æ­¢æ­»å¾ªç¯èµ°å›å¤´è·¯ï¼‰
    // è¿™é‡Œçš„ 2 è¡¨ç¤ºâ€œå·²è®¿é—®â€
    grid[r][c] = 2; // concept: çŠ¶æ€æ ‡è®°

    // 4. é€’å½’å°è¯•ï¼šä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘
    // åªè¦æœ‰ä¸€ä¸ªæ–¹å‘èƒ½é€šï¼Œå°±è¿”å› true
    if (findPath(grid, r + 1, c) || // ä¸‹
        findPath(grid, r, c + 1) || // å³
        findPath(grid, r - 1, c) || // ä¸Š
        findPath(grid, r, c - 1)) { // å·¦
        return true;
    }

    // 5. å›æº¯ (Backtracking)ï¼šå…³é”®æ­¥éª¤ï¼
    // å¦‚æœå››ä¸ªæ–¹å‘éƒ½èµ°ä¸é€šï¼Œè¯´æ˜å½“å‰ç‚¹é€‰é”™äº†ã€‚
    // åœ¨è¿”å› false ä¹‹å‰ï¼Œå¿…é¡»æŠŠå½“å‰ç‚¹çš„æ ‡è®°è¿˜åŸï¼
    // å¦åˆ™ä¼šå½±å“å…¶ä»–è·¯å¾„çš„å°è¯•ã€‚
    grid[r][c] = 0; // concept: çŠ¶æ€å¤åŸ

    return false;
}

```

**æ”¶ç›Šåˆ†æ**ï¼š
å›æº¯æ³•å°†â€œç©·ä¸¾â€å˜å¾—æ™ºèƒ½åŒ–ï¼Œé€šè¿‡â€œå‰ªæâ€ï¼ˆé‡åˆ°æ­»èƒ¡åŒç›´æ¥å›å¤´ï¼‰å¤§å¤§å‡å°‘äº†è®¡ç®—é‡ã€‚

---

### ğŸ“ 3.3 å®æˆ˜æŒ‘æˆ˜

**ç›®æ ‡**ï¼šé€šè¿‡ä¸€ä¸ªç»å…¸çš„å­—ç¬¦ä¸²å¤„ç†é—®é¢˜ï¼Œæ£€éªŒä½ å¯¹**ç»ˆæ­¢æ¡ä»¶**å’Œ**é€’å½’æ‹†è§£**çš„æŒæ¡ã€‚

**åœºæ™¯ï¼šå›æ–‡æ£€æµ‹ (Palindrome Check)**
å›æ–‡æ˜¯æŒ‡æ­£è¯»å’Œåè¯»éƒ½ä¸€æ ·çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ "racecar"ã€"level"ã€"a"ã€‚

**è¦æ±‚**ï¼š

1. **ç¦æ­¢**ä½¿ç”¨ `StringBuilder.reverse()` ç­‰ç°æˆ APIã€‚
2. å¿…é¡»ä½¿ç”¨**é€’å½’**å®ç°ã€‚
3. è€ƒè™‘ç©ºå­—ç¬¦ä¸²æˆ–å•å­—ç¬¦çš„æƒ…å†µã€‚

**è¯·ä¿®å¤å¹¶å®Œæˆä»¥ä¸‹ä»£ç **ï¼š

```java
/**
 * æŒ‘æˆ˜ï¼šç”¨é€’å½’åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºå›æ–‡
 */
public class PalindromeChallenge {

    public static boolean isPalindrome(String s) {
        // TODO: 1. å†™å‡ºç»ˆæ­¢æ¡ä»¶ (Base Case)
        // æç¤ºï¼šä»€ä¹ˆæƒ…å†µä¸‹å­—ç¬¦ä¸²è‚¯å®šæ˜¯å›æ–‡ï¼Ÿ(é•¿åº¦ä¸º0æˆ–1)
        
        
        // TODO: 2. å†™å‡ºé€’å½’é€»è¾‘ (Recursive Step)
        // æç¤ºï¼šæ¯”è¾ƒé¦–å°¾å­—ç¬¦ï¼Œå¦‚æœç›¸åŒï¼Œåˆ™é€’å½’æ£€æŸ¥ä¸­é—´çš„éƒ¨åˆ†
        // æ¯”å¦‚ check("racecar") -> 'r'=='r' AND check("aceca")
        
        return false; // å ä½ç¬¦
    }

    public static void main(String[] args) {
        System.out.println(isPalindrome("racecar")); // åº”è¾“å‡º true
        System.out.println(isPalindrome("hello"));   // åº”è¾“å‡º false
    }
}

```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“ æäº¤ä½ çš„ä»£ç 
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
è¯·å°è¯•è¡¥å…¨ä»£ç ã€‚æˆ‘ä¼šè¿›è¡Œ Code Reviewï¼š

1. æ£€æŸ¥è¾¹ç•Œæ¡ä»¶ï¼ˆ`String` æ“ä½œæœ€å®¹æ˜“è¶Šç•Œï¼‰ã€‚
2. è¯„ä¼°é€’å½’é€»è¾‘çš„ç®€æ´æ€§ã€‚
3. ç»™å‡ºæ ‡å‡†çš„æœ€ä¼˜è§£ã€‚
