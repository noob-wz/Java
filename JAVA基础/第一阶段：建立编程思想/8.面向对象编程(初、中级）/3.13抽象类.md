**æ ¸å¿ƒä»·å€¼**ï¼šå®ƒæ˜¯ä»£ç å¤ç”¨çš„åŸºçŸ³ï¼Œè®©ä½ èƒ½å®šä¹‰"æ¨¡æ¿"ï¼Œå¼ºåˆ¶å­ç±»å¿…é¡»åšä»€ä¹ˆï¼ŒåŒæ—¶å¸®å­ç±»å¤„ç†å¥½é€šç”¨çš„é€»è¾‘ã€‚

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

## ç¬¬1éƒ¨åˆ†ï¼šå»ºç«‹è®¤çŸ¥ (What & Why)

### ğŸ“¦ 1.1 æ€ä¹ˆå†™ï¼šæ ¸å¿ƒè¯­æ³• *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**æŒæ¡** `abstract` å…³é”®å­—çš„è¯­æ³•è§„åˆ™ï¼Œä»¥**å®šä¹‰åŒ…å«æœªå®ç°è¡Œä¸ºçš„ç±»ç»“æ„**ã€‚

æŠ½è±¡ç±»æ˜¯ä¸€ç§"åŠæˆå“"ç±»ã€‚å®ƒå°±åƒä¸€ä»½**å¡«ç©ºé¢˜**ï¼Œå†™å¥½äº†ä¸€éƒ¨åˆ†ç­”æ¡ˆï¼ˆå…·ä½“æ–¹æ³•ï¼‰ï¼Œç•™äº†ä¸€éƒ¨åˆ†ç©ºï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰è®©å­ç±»å»å¡«ã€‚

**åŸºç¡€è¯­æ³•ç»“æ„**ï¼š

```java
// 1. ä½¿ç”¨ abstract å…³é”®å­—ä¿®é¥°ç±»
public abstract class AbstractPayment {

    // âœ… æ™®é€šæˆå‘˜å˜é‡ï¼ˆå­ç±»å¯ä»¥å¤ç”¨ï¼‰
    protected String paymentId;

    // âœ… æ„é€ å™¨ï¼ˆè™½ç„¶æŠ½è±¡ç±»ä¸èƒ½newï¼Œä½†æ„é€ å™¨å¿…é¡»å­˜åœ¨ï¼ï¼‰
    // ç”¨äºåˆå§‹åŒ–ä¸Šé¢çš„æˆå‘˜å˜é‡
    public AbstractPayment(String paymentId) {
        this.paymentId = paymentId;
    }

    // âœ… æ™®é€šæ–¹æ³•ï¼ˆå…·ä½“å®ç°ï¼Œå­ç±»å¯ä»¥ç›´æ¥ç”¨ï¼‰
    // è¿™é‡Œçš„ final æ˜¯æœ€ä½³å®è·µï¼Œé˜²æ­¢å­ç±»ç¯¡æ”¹é€šç”¨é€»è¾‘ï¼ˆåç»­è¯¦è¿°ï¼‰
    public final void logTransaction() {
        System.out.println("è®°å½•äº¤æ˜“æ—¥å¿—: " + paymentId);
    }

    // âœ… æŠ½è±¡æ–¹æ³•ï¼ˆåªæœ‰ç­¾åï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼ï¼‰
    // å«ä¹‰ï¼šæˆ‘ä¸çŸ¥é“å…·ä½“æ€ä¹ˆåšï¼Œå­ç±»å¿…é¡»å‘Šè¯‰æˆ‘
    // è§„åˆ™ï¼š
    // 1. å¿…é¡»ç”¨ abstract ä¿®é¥°
    // 2. ç»“å°¾å¿…é¡»æ˜¯åˆ†å· ; ä¸èƒ½æœ‰ {}
    public abstract void performPay(double amount);
}

```

**æŠ½è±¡ç±»çš„è¯­æ³•é“å¾‹ï¼ˆè¿åå³ç¼–è¯‘é”™è¯¯ï¼‰**ï¼š

1. **ä¸èƒ½å®ä¾‹åŒ–**ï¼š`new AbstractPayment()` âŒ æ˜¯éæ³•çš„ã€‚è®¾è®¡åˆè¡·æ˜¯å› ä¸ºå…¶åˆ›å»ºå®ä¾‹æœ¬èº«æ²¡æœ‰å®é™…æ„ä¹‰
2. **æœ‰æŠ½è±¡æ–¹æ³•å¿…æŠ½è±¡**ï¼šå¦‚æœä¸€ä¸ªç±»åŒ…å«æŠ½è±¡æ–¹æ³•ï¼Œè¯¥ç±»å¿…é¡»å£°æ˜ä¸º `abstract`ã€‚ä½†æ˜¯æŠ½è±¡ç±»å¯ä»¥æ²¡æœ‰æŠ½è±¡æ–¹æ³•
3. **å­ç±»å¿…é¡»è¿˜å€º**ï¼šç»§æ‰¿æŠ½è±¡ç±»çš„å­ç±»ï¼Œ**å¿…é¡»**é‡å†™ï¼ˆå®ç°ï¼‰æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œé™¤éå­ç±»è‡ªå·±ä¹Ÿæ˜¯æŠ½è±¡ç±»ã€‚

**æŠ½è±¡æ–¹æ³•çš„è¯­æ³•é“å¾‹ï¼ˆè¿åå³ç¼–è¯‘é”™è¯¯ï¼‰**ï¼š

1. **ä¸èƒ½æ­é… `private` ä½¿ç”¨**ï¼šå­ç±»å› ä¸ºçœ‹ä¸è§çˆ¶ç±»çš„ç§æœ‰æ–¹æ³•ï¼Œæ‰€ä»¥æ— æ³•é‡å†™ã€‚çˆ¶ç±»åˆæ²¡æœ‰æ–¹æ³•ä½“ï¼Œè¿™å¯¼è‡´è¿™ä¸ªæ–¹æ³•æ°¸è¿œæ— æ³•è¢«æ‰§è¡Œã€‚
2. **ä¸èƒ½æ­é… `final` ä½¿ç”¨**ï¼š`final` ç¦æ­¢é‡å†™ï¼Œé€»è¾‘çŸ›ç›¾
3. **ä¸èƒ½æ­é… `static` ä½¿ç”¨**ï¼šå±äºç±»ï¼Œä¸å±äºå¯¹è±¡ã€‚é™æ€æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼ˆåªèƒ½è¢«éšè—ï¼‰

---

### ğŸ”— 1.2 æ‡‚åŸç†ï¼šå‰ç½®ä¾èµ–æ¦‚å¿µ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**ç†è§£**æ„é€ å™¨é“¾ä¸å¤šæ€æœºåˆ¶ï¼Œä»¥**ç¡®ä¿å¯¹è±¡çŠ¶æ€è¢«æ­£ç¡®åˆå§‹åŒ–**ã€‚

åœ¨ä½¿ç”¨æŠ½è±¡ç±»æ—¶ï¼Œç¼–è¯‘å™¨åœ¨èƒŒåé»˜é»˜åšäº†å¾ˆå¤šå·¥ä½œã€‚

#### 1. æ„é€ å™¨çš„éšå¼è¡Œä¸ºï¼ˆWhy Super?ï¼‰

å¾ˆå¤šåˆå­¦è€…å›°æƒ‘ï¼š**"æ—¢ç„¶ä¸èƒ½ new æŠ½è±¡ç±»ï¼Œä¸ºä»€ä¹ˆå®ƒè¿˜éœ€è¦æ„é€ å™¨ï¼Ÿ"**

* **åŸç†**ï¼šå­ç±»å¯¹è±¡å®ä¾‹åŒ–æ—¶ï¼Œ**å¿…é¡»å…ˆåˆå§‹åŒ–çˆ¶ç±»çš„éƒ¨åˆ†**ã€‚
* **æ‰§è¡Œæµ**ï¼š`SubClass new` -> `SubClass Constructor` -> `AbstractClass Constructor` -> `Object Constructor`ã€‚

#### 2. å¤šæ€ä¸ Override

æŠ½è±¡ç±»çš„æ ¸å¿ƒåœ¨äº"çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡"ã€‚

```java
// ç¼–è¯‘å™¨è§†è§’
AbstractPayment payment = new WeChatPay(); // âœ… åˆæ³•
payment.performPay(100.0); 

// è¿è¡Œæ—¶è¡Œä¸ºï¼š
// è™½ç„¶ç±»å‹æ˜¯ AbstractPaymentï¼Œä½†å®é™…æ‰§è¡Œçš„æ˜¯ WeChatPay çš„ performPay æ–¹æ³•

```

---

### ğŸš€ 1.3 å¿«é€Ÿä¸Šæ‰‹è·‘èµ·æ¥ï¼šæœ€å°å¯è¡Œæ¡ˆä¾‹ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**æ„å»º**ä¸€ä¸ªå¯è¿è¡Œçš„ç»§æ‰¿ä½“ç³»ï¼Œ**éªŒè¯**æŠ½è±¡ç±»çš„çº¦æŸèƒ½åŠ›ã€‚

æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„æ”¯ä»˜æ¼”ç¤ºã€‚

```java
// ğŸ“„ æ–‡ä»¶åï¼šPaymentDemo.java

// 1. å®šä¹‰æŠ½è±¡çˆ¶ç±»
abstract class AbstractPayment {
    protected String channelName;

    public AbstractPayment(String name) {
        this.channelName = name;
    }

    // é€šç”¨é€»è¾‘ï¼šæ‰“å°æ¬¢è¿è¯­
    public void welcome() {
        System.out.println("æ­£åœ¨è¿æ¥ [" + channelName + "] æ¸ é“...");
    }

    // æŠ½è±¡é€»è¾‘ï¼šå…·ä½“çš„æ”¯ä»˜åŠ¨ä½œ
    public abstract void pay(double amount);
}

// 2. å®šä¹‰å…·ä½“å­ç±»ï¼šæ”¯ä»˜å®
class AliPay extends AbstractPayment {
    public AliPay() {
        super("æ”¯ä»˜å®"); // âš¡ï¸ å¿…é¡»è°ƒç”¨çˆ¶ç±»æ„é€ å™¨
    }

    @Override
    public void pay(double amount) {
        System.out.println("âœ… æ”¯ä»˜å®æ‰«è„¸æ”¯ä»˜æˆåŠŸï¼š$" + amount);
    }
}

// 3. å®šä¹‰å…·ä½“å­ç±»ï¼šå¾®ä¿¡æ”¯ä»˜
class WeChatPay extends AbstractPayment {
    public WeChatPay() {
        super("å¾®ä¿¡æ”¯ä»˜");
    }

    @Override
    public void pay(double amount) {
        System.out.println("âœ… å¾®ä¿¡å…å¯†æ”¯ä»˜æˆåŠŸï¼š$" + amount);
    }
}

// 4. Main æ–¹æ³•æµ‹è¯•
public class PaymentDemo {
    public static void main(String[] args) {
        // å¤šæ€ç”¨æ³•
        AbstractPayment payment1 = new AliPay();
        payment1.welcome();      // è°ƒç”¨çˆ¶ç±»å…·ä½“æ–¹æ³•
        payment1.pay(88.5);      // è°ƒç”¨å­ç±»å®ç°æ–¹æ³•

        System.out.println("---");

        AbstractPayment payment2 = new WeChatPay();
        payment2.welcome();
        payment2.pay(20.0);
    }
}

```

**è¿è¡Œç»“æœ**ï¼š

```text
æ­£åœ¨è¿æ¥ [æ”¯ä»˜å®] æ¸ é“...
âœ… æ”¯ä»˜å®æ‰«è„¸æ”¯ä»˜æˆåŠŸï¼š$88.5
---
æ­£åœ¨è¿æ¥ [å¾®ä¿¡æ”¯ä»˜] æ¸ é“...
âœ… å¾®ä¿¡å…å¯†æ”¯ä»˜æˆåŠŸï¼š$20.0

```

---

### ğŸ’¡ 1.4 ä¸ºä»€ä¹ˆï¼šè®¾è®¡åˆè¡·ä¸æƒè¡¡ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**å¯¹æ¯”**ç©ºæ–¹æ³•å®ç°ä¸æŠ½è±¡æ–¹æ³•ï¼Œ**é¢†æ‚Ÿ**å¼ºåˆ¶å¥‘çº¦çš„ä»·å€¼ã€‚

åœ¨æ²¡æœ‰æŠ½è±¡ç±»ä¹‹å‰ï¼Œå¦‚æœçˆ¶ç±»ä¸çŸ¥é“å…·ä½“æ€ä¹ˆå®ç°æŸä¸ªæ–¹æ³•ï¼Œç¨‹åºå‘˜é€šå¸¸ä¼šå†™ä¸ª"ç©ºæ–¹æ³•"ï¼š

**âŒ ç³Ÿç³•çš„æ—§åšæ³•ï¼ˆWithout Abstractï¼‰**ï¼š

```java
class BadPayment {
    public void pay(double amount) {
        // ç•™ç©ºï¼Œæˆ–è€…æŠ›ä¸ªå¼‚å¸¸ï¼Œä»¥æ­¤å‡è£…å®ƒæ˜¯"æŠ½è±¡"çš„
        // éšæ‚£ï¼šå­ç±»å¦‚æœå¿˜äº†é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¸ä¼šæŠ¥é”™ï¼
        // è¿è¡Œæ—¶ä¼šé™é»˜å¤±è´¥ï¼Œæˆ–è€…æŠ›å‡ºæ„æƒ³ä¸åˆ°çš„å¼‚å¸¸ã€‚
    }
}

```

**âœ… æŠ½è±¡ç±»çš„ä¼˜åŠ¿ï¼ˆWith Abstractï¼‰**ï¼š

```java
abstract class GoodPayment {
    // å¼ºåˆ¶å¥‘çº¦ï¼šå­ç±»ä¸é‡å†™ï¼Œä»£ç è¿ç¼–è¯‘éƒ½è¿‡ä¸äº†ï¼
    // è¿™ä¸€è¡Œä»£ç å°±åœ¨ç¼–è¯‘å™¨å±‚é¢æ¶ˆç­äº† Bugã€‚
    public abstract void pay(double amount);
}

```

**è®¾è®¡æƒè¡¡**ï¼š

| ç»´åº¦ | æŠ½è±¡ç±» (Abstract Class) | æ™®é€šç±» (Concrete Class) |
| --- | --- | --- |
| **å¼ºåˆ¶æ€§** | **é«˜** (å¼ºåˆ¶å­ç±»å®ç°æŠ½è±¡æ–¹æ³•) | ä½ (å­ç±»å¯ä»¥é€‰æ‹©æ€§é‡å†™) |
| **çµæ´»æ€§** | ä½ (ä¸èƒ½å®ä¾‹åŒ–) | é«˜ (å¯ä»¥ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨) |
| **è¯­ä¹‰** | "Is-A" ä¸”"ä¸å®Œæ•´" | "Is-A" ä¸”"å®Œæ•´" |

---

### âš™ï¸ 1.5 åº•å±‚åŸç†ï¼šå†…å­˜æ¨¡å‹ç¤ºæ„ *â­ è¿›é˜¶é€‰å­¦*

**ç›®æ ‡**ï¼š**å»ºç«‹**æŠ½è±¡ç±»åœ¨å†…å­˜ä¸­çš„å­˜åœ¨å½¢å¼ï¼Œ**æ¶ˆé™¤**"æŠ½è±¡ç±»ä¸å­˜åœ¨"çš„è¯¯è§£ã€‚

è™½ç„¶ä¸èƒ½ `new AbstractPayment()`ï¼Œä½†åœ¨åŠ è½½å­ç±»æ—¶ï¼ŒæŠ½è±¡ç±»çš„ç»“æ„ä¾ç„¶å­˜åœ¨äºæ–¹æ³•åŒºï¼ˆMetaspaceï¼‰ã€‚

**ASCII å†…å­˜å¸ƒå±€ç¤ºæ„**ï¼š

```
Method Area (Metaspace)           Heap Memory (Instance of AliPay)
+-----------------------+         +-----------------------------+
| Class: AbstractPayment|         | Object Header               |
|-----------------------|         |-----------------------------|
| method: welcome() [Code] <------+ vtable[0]: Abstract.welcome |
| method: pay() [ABSTRACT]|       |                             |
+-----------------------+         | vtable[1]: AliPay.pay       |
            ^                     |-----------------------------|
            | (extends)           | field: channelName = "æ”¯ä»˜å®"|
            |                     +-----------------------------+
+-----------------------+
| Class: AliPay         |
|-----------------------|
| method: pay() [Code]  |
+-----------------------+

```

* **å…³é”®ç‚¹**ï¼šå †å†…å­˜ä¸­åªæœ‰ `AliPay` çš„å¯¹è±¡ï¼Œä½†è¿™ä¸ªå¯¹è±¡å†…éƒ¨åŒ…å«äº†çˆ¶ç±» `AbstractPayment` å®šä¹‰çš„å­—æ®µï¼ˆå¦‚ `channelName`ï¼‰ï¼Œä¸”è™šæ–¹æ³•è¡¨ï¼ˆvtableï¼‰ä¸­æŒ‡å‘äº†å…·ä½“çš„å®ç°ä»£ç ã€‚

---

## ç¬¬2éƒ¨åˆ†ï¼šå·¥ç¨‹å®è·µ (How to Do Right)

åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æŠŠæŠ½è±¡ç±»æ”¾å…¥**çœŸå®çš„ç”µå•†ä¸šåŠ¡**ä¸­ï¼Œå­¦ä¹ å¦‚ä½•å†™å‡ºç¬¦åˆå¤§å‚è§„èŒƒçš„ç”Ÿäº§çº§ä»£ç ã€‚

### ğŸ” å‰ç½®çŸ¥è¯†æ£€æŸ¥

1. **æ¨¡æ¿æ–¹æ³•æ¨¡å¼ (Template Method)**ï¼šæœ¬èŠ‚æ ¸å¿ƒã€‚å®ƒæŒ‡å®šä¹‰ä¸€ä¸ªç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚
2. **protected å…³é”®å­—**ï¼šåœ¨1.1ä¸­ç®€ç•¥æè¿‡ï¼Œæœ¬èŠ‚å°†æ·±å…¥å…¶åœ¨ç»§æ‰¿ä½“ç³»ä¸­çš„æ§åˆ¶æƒä½œç”¨ã€‚

---

### ğŸŒ 2.1 çœŸå®åœºæ™¯ï¼šæ”¯ä»˜ç½‘å…³çš„æ ‡å‡†åŒ–æµç¨‹ *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**åº”ç”¨**æŠ½è±¡ç±»æ„å»ºæ”¯ä»˜æµç¨‹éª¨æ¶ï¼Œ**æ¶ˆé™¤**å¤šä¸ªæ”¯ä»˜æ¸ é“ä»£ç ä¸­çš„é‡å¤é€»è¾‘ã€‚

åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œæ— è®ºæ˜¯æ”¯ä»˜å®ã€å¾®ä¿¡è¿˜æ˜¯é“¶è”ï¼Œæ”¯ä»˜æµç¨‹å¤§è‡´éƒ½æ˜¯ä¸€æ ·çš„ï¼š
`å‚æ•°æ ¡éªŒ` -> `é£æ§æ£€æŸ¥` -> `æ‰§è¡Œæ‰£æ¬¾(å·®å¼‚ç‚¹)` -> `è®°å½•æµæ°´`ã€‚

å¦‚æœæ¯ä¸ªç±»éƒ½æŠŠè¿™å¥—æµç¨‹å†™ä¸€éï¼Œç»´æŠ¤æ—¶å°±æ˜¯ç¾éš¾ï¼ˆæ¯”å¦‚è¦åŠ ä¸€ä¸ªâ€œçŸ­ä¿¡é€šçŸ¥â€ï¼Œå¾—æ”¹ N ä¸ªæ–‡ä»¶ï¼‰ã€‚

**âŒ é”™è¯¯åšæ³•ï¼ˆé‡å¤ä»£ç ï¼‰**ï¼š
`AliPay` å’Œ `WeChatPay` å„è‡ªæŠŠæ ¡éªŒã€é£æ§ã€æ—¥å¿—å…¨å†™äº†ä¸€éï¼Œåªæœ‰æ‰£æ¬¾é€»è¾‘ä¸åŒã€‚

**âœ… æ­£ç¡®åšæ³•ï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰**ï¼š
ä½¿ç”¨æŠ½è±¡ç±»å®šä¹‰**æ ‡å‡†æµç¨‹ï¼ˆéª¨æ¶ï¼‰**ï¼ŒåªæŠŠ**å·®å¼‚ç‚¹**ç•™ç»™å­ç±»ã€‚

**ä¸šåŠ¡æµç¨‹å›¾**ï¼š

```
      [æŠ½è±¡çˆ¶ç±»ï¼šAbstractPaymentProcessor]
                   |
   +---------------+---------------+
   | public process(Order order)   | <--- å¯¹å¤–æš´éœ²çš„å”¯ä¸€å…¥å£
   +---------------+---------------+
                   |
        1. validate() [é€šç”¨é€»è¾‘]
                   |
        2. riskCheck() [é€šç”¨é€»è¾‘]
                   |
        3. doPay() [âš ï¸ æŠ½è±¡æ–¹æ³•] ----> ç”±å­ç±»(AliPay/WeChat)å…·ä½“å®ç°
                   |
        4. log() [é€šç”¨é€»è¾‘]

```

**ç”Ÿäº§çº§ä»£ç ç¤ºä¾‹**ï¼š

```java
// åŸºç¡€è®¢å•ç±»ï¼ˆæ¨¡æ‹Ÿä¸šåŠ¡å¯¹è±¡ï¼‰
record Order(String orderId, double amount, String user) {}

// 1. å®šä¹‰æŠ½è±¡åŸºç±»
public abstract class AbstractPaymentProcessor {

    // ğŸŸ¢ æ ¸å¿ƒæ¨¡å¼ï¼šæ¨¡æ¿æ–¹æ³• (Template Method)
    // 1. å¿…é¡»æ˜¯ publicï¼šè¿™æ˜¯ç»™å¤–éƒ¨è°ƒç”¨çš„å”¯ä¸€å…¥å£
    // 2. å¿…é¡»æ˜¯ finalï¼šä¸¥ç¦å­ç±»ä¿®æ”¹æµç¨‹é¡ºåºï¼ˆå®‰å…¨ä¿éšœï¼‰
   
    // æ¨¡æ¿è®¾è®¡æ¨¡å¼å®Œç¾è¯ é‡Šäº†æŠ½è±¡ç±»çš„å­˜åœ¨æ„ä¹‰ï¼š
    // ï¼ˆ1ï¼‰å°è£…ä¸å˜éƒ¨åˆ†ï¼ˆæµç¨‹ã€é€šç”¨ä»£ç ï¼‰ -> çˆ¶ç±»å®ç° (public final)
    // ï¼ˆ2ï¼‰æ‰©å±•å¯å˜éƒ¨åˆ†ï¼ˆä¸šåŠ¡ç»†èŠ‚ï¼‰ -> å­ç±»å®ç° (protected abstract)
    public final void processPayment(Order order) {
        // æ­¥éª¤1ï¼šé€šç”¨æ ¡éªŒ
        if (order.amount() <= 0) {
            throw new IllegalArgumentException("é‡‘é¢éæ³•");
        }
        System.out.println("Step 1: å‚æ•°æ ¡éªŒé€šè¿‡");

        // æ­¥éª¤2ï¼šæ‰§è¡Œå…·ä½“æ‰£æ¬¾ï¼ˆæ ¸å¿ƒå·®å¼‚ç‚¹ï¼‰
        // è¿™ä¸€æ­¥çˆ¶ç±»åšä¸äº†ï¼Œæ¨ç»™å­ç±»åš
        boolean success = doPay(order);

        // æ­¥éª¤3ï¼šé€šç”¨åç½®å¤„ç†
        if (success) {
            logTransaction(order, "SUCCESS");
        } else {
            logTransaction(order, "FAILED");
        }
    }

    // âš ï¸ æŠ½è±¡æ–¹æ³•ï¼šç•™ç»™å­ç±»å¡«ç©º
    // protected è®¿é—®æƒé™ï¼šåªå…è®¸å­ç±»å®ç°ï¼Œä¸å…è®¸å¤–éƒ¨ç›´æ¥è°ƒç”¨
    protected abstract boolean doPay(Order order);

    // ğŸ”’ ç§æœ‰é€šç”¨æ–¹æ³•ï¼šå­ç±»æ— éœ€å…³å¿ƒ
    private void logTransaction(Order order, String status) {
        System.out.println("Step 3: è®¢å• " + order.orderId() + " çŠ¶æ€æ›´æ–°ä¸º: " + status);
    }
}

// 2. å…·ä½“å­ç±»ï¼šå¾®ä¿¡æ”¯ä»˜
class WeChatProcessor extends AbstractPaymentProcessor {
    @Override
    protected boolean doPay(Order order) {
        System.out.println("Step 2: ğŸŸ¢ è°ƒç”¨å¾®ä¿¡APIæ‰£æ¬¾: " + order.amount());
        return true; // æ¨¡æ‹ŸæˆåŠŸ
    }
}

```

**ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™æ›´ä¸“ä¸šï¼Ÿ**

1. **æ§åˆ¶åè½¬**ï¼šçˆ¶ç±»æ§åˆ¶æµç¨‹ï¼Œå­ç±»åªè´Ÿè´£å¡«ç©ºã€‚
2. **å®‰å…¨**ï¼š`processPayment` æ˜¯ `final` çš„ï¼Œé˜²æ­¢å­ç±»ç»•è¿‡é£æ§æ£€æŸ¥ã€‚
3. **å°è£…**ï¼š`doPay` æ˜¯ `protected` çš„ï¼Œå¤–éƒ¨è°ƒç”¨è€…åªèƒ½è°ƒ `processPayment`ï¼Œä¸èƒ½è·³è¿‡æµç¨‹ç›´æ¥è°ƒ `doPay`ã€‚

---

### âœ… 2.2 æ€ä¹ˆå†™å¥½ï¼šç”Ÿäº§çº§ä»£ç æ ‡å‡† *ğŸ”¥ å®æˆ˜å¿…å¤‡*

**ç›®æ ‡**ï¼š**éµå¾ª**ä¸šç•Œå‘½åä¸è®¾è®¡è§„èŒƒï¼Œ**æå‡**ä»£ç çš„å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚

#### ğŸŸ¢ GREENï¼ˆæ¨èé£æ ¼ï¼‰

1. **å‘½åè§„èŒƒ**ï¼š
   * å¿…é¡»ä»¥ `Abstract` æˆ– `Base` å¼€å¤´ã€‚
   * ç¤ºä¾‹ï¼š`AbstractMap` (JDK), `BaseExecutor`.
   * *ç†ç”±ï¼šè¯»ä»£ç çš„äººä¸€çœ¼å°±èƒ½çœ‹å‡ºè¿™æ˜¯ä¸ªä¸èƒ½ new çš„åŠæˆå“ã€‚*

2. **æƒé™æ§åˆ¶**ï¼š
   * æŠ½è±¡æ–¹æ³•å°½é‡ä½¿ç”¨ `protected`ã€‚
   * *ç†ç”±ï¼šé€šå¸¸æŠ½è±¡æ–¹æ³•æ˜¯å®ç°ç»†èŠ‚ï¼Œä¸éœ€è¦å¯¹æ•´ä¸ªä¸–ç•Œå…¬å¼€ï¼Œåªéœ€è¦å¯¹å­ç±»å…¬å¼€ã€‚*

3. **ä½¿ç”¨ç»„åˆä¼˜äºç»§æ‰¿**ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰ï¼š
   * å¦‚æœæŠ½è±¡ç±»åªæ˜¯ä¸ºäº†å¤ç”¨ä»£ç ï¼ˆæ²¡æœ‰ Is-A å…³ç³»ï¼‰ï¼Œè€ƒè™‘æ”¹å†™ä¸ºå·¥å…·ç±»æˆ–ç»„åˆæ¨¡å¼ã€‚

#### ğŸ”´ REDï¼ˆå¼ºåˆ¶è§„èŒƒï¼‰

1. **ç¦æ­¢åœ¨æ„é€ å™¨ä¸­è°ƒç”¨æŠ½è±¡æ–¹æ³•**ï¼š
   * è¿™æ˜¯ Java ä¸­æåº¦å±é™©çš„æ“ä½œï¼
   * *åŸå› *ï¼šçˆ¶ç±»æ„é€ å™¨è¿è¡Œæ—¶ï¼Œå­ç±»å­—æ®µè¿˜æ²¡åˆå§‹åŒ–ã€‚å¦‚æœå­ç±»å®ç°çš„æŠ½è±¡æ–¹æ³•é‡Œç”¨åˆ°äº†å­ç±»å­—æ®µï¼Œä¼šè¯»åˆ°é»˜è®¤å€¼ï¼ˆnull/0ï¼‰ï¼Œå¯¼è‡´ç©ºæŒ‡é’ˆæˆ–é€»è¾‘é”™è¯¯ã€‚

```java
// âŒ ç»å¯¹ç¦æ­¢çš„ä»£ç 
abstract class Dangerous {
    public Dangerous() {
        init(); // <--- è°ƒç”¨äº†æŠ½è±¡æ–¹æ³•ï¼
    }
    abstract void init();
}

class Child extends Dangerous {
    private String config = "Config Loaded";

    @Override
    void init() {
        // ğŸ’¥ æ­¤æ—¶ config è¿˜æ˜¯ nullï¼å› ä¸º Child çš„æ„é€ å™¨è¿˜æ²¡è·‘å®Œï¼
        System.out.println(config.length()); 
    }
}

```



---

### ğŸ”„ 2.3 å†³ç­–æŒ‡å—ï¼šæ¥å£ vs æŠ½è±¡ç±» *ğŸ’¡ æ ¸å¿ƒå¿…å­¦*

**ç›®æ ‡**ï¼š**è¾¨æ** Java 8 å¼•å…¥é»˜è®¤æ–¹æ³•åçš„æŠ€æœ¯è¾¹ç•Œï¼Œ**åˆ¶å®š**é€‰å‹ç­–ç•¥ã€‚

è‡ªä» Java 8 æ¥å£å¯ä»¥å†™ `default` æ–¹æ³•åï¼Œæ¥å£å’ŒæŠ½è±¡ç±»è¶Šæ¥è¶Šåƒã€‚å¾ˆå¤šåŒå­¦ä¼šé—®ï¼š*"è¿˜éœ€è¦æŠ½è±¡ç±»å—ï¼Ÿ"*

**ç­”æ¡ˆæ˜¯ï¼šéœ€è¦ã€‚ä½†åœºæ™¯å˜çª„äº†ã€‚*

#### æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨

| ç»´åº¦ | æŠ½è±¡ç±» (Abstract Class) | æ¥å£ (Interface) |
| --- | --- | --- |
| **æ ¸å¿ƒæœ¬è´¨** | **Is-A (æ˜¯...)** | **Can-Do (èƒ½...)** |
| **çŠ¶æ€ç®¡ç†** | âœ… **å¯ä»¥æœ‰éé™æ€æˆå‘˜å˜é‡** (æ ¸å¿ƒä¼˜åŠ¿) | âŒ åªèƒ½æœ‰ `public static final` å¸¸é‡ |
| **æ„é€ å™¨** | âœ… æœ‰ï¼Œç”¨äºåˆå§‹åŒ–çŠ¶æ€ | âŒ æ—  |
| **å¤šç»§æ‰¿** | âŒ å•ç»§æ‰¿ (Java é™åˆ¶) | âœ… å¤šå®ç° |
| **è®¿é—®æ§åˆ¶** | âœ… `public`, `protected`, `package` | âš ï¸ åªæœ‰ `public` (Java 9+ æœ‰ `private`) |

#### ğŸŒ³ é€‰å‹å†³ç­–æ ‘

```
ä½ éœ€è¦ã€ä¿å­˜çŠ¶æ€ã€‘å—ï¼Ÿ(ä¾‹å¦‚ï¼šæˆå‘˜å˜é‡ name, id, state)
  |
  â”œâ”€ YES â”€> å¿…é¡»ç”¨ã€æŠ½è±¡ç±»ã€‘ (æ¥å£å­˜ä¸äº†çŠ¶æ€)
  |
  â””â”€ NO â”€> æ˜¯å¦æœ‰ã€ä¸¥æ ¼çš„ Is-A å…³ç³»ã€‘ï¼Ÿ
             |
             â”œâ”€ YES â”€> ä¼˜å…ˆè€ƒè™‘ã€æŠ½è±¡ç±»ã€‘(ä¾¿äºä»£ç å¤ç”¨å’Œæ§åˆ¶æµç¨‹)
             |
             â””â”€ NO â”€> ä½¿ç”¨ã€æ¥å£ã€‘(è·å¾—å¤šå®ç°çš„çµæ´»æ€§)

```

**æœ€ä½³å®è·µæ€»ç»“**ï¼š

* å¦‚æœåªæ˜¯å®šä¹‰**è¡Œä¸ºå¥‘çº¦**ï¼ˆå¦‚ `Runnable`, `Comparable`ï¼‰ï¼Œç”¨**æ¥å£**ã€‚
* å¦‚æœè¦æ„å»º**éª¨æ¶å®ç°**ä¸”éœ€è¦**ç»´æŠ¤çŠ¶æ€**ï¼ˆå¦‚ `AbstractPaymentProcessor` é‡Œçš„ `paymentId`ï¼‰ï¼Œç”¨**æŠ½è±¡ç±»**ã€‚
* **JDK ç»å…¸æ¨¡å¼**ï¼šæ¥å£å®šä¹‰ç±»å‹ (`List`) -> æŠ½è±¡ç±»æä¾›éª¨æ¶ (`AbstractList`) -> å…·ä½“ç±»å®ç° (`ArrayList`)ã€‚

---

## ç¬¬3éƒ¨åˆ†ï¼šé¿å‘è¿›é˜¶ (What to Avoid & Beyond)

åœ¨æŒæ¡äº†æ ‡å‡†å†™æ³•åï¼Œæˆ‘ä»¬è¿›å…¥æœ€åé˜¶æ®µï¼šå¦‚ä½•é¿å…è®¾è®¡ä¸Šçš„"åœ°é›·"ï¼Œä»¥åŠå¦‚ä½•åƒæ¶æ„å¸ˆä¸€æ ·æ€è€ƒã€‚

### ğŸ” å‰ç½®çŸ¥è¯†æ£€æŸ¥

1. **é‡Œæ°æ›¿æ¢åŸåˆ™ (LSP)**ï¼šæœ¬é˜¶æ®µæ ¸å¿ƒè®¾è®¡åŸåˆ™ã€‚ç®€å•è¯´å°±æ˜¯ï¼š*æ‰€æœ‰å¼•ç”¨çˆ¶ç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»å¯¹è±¡*ã€‚
2. **å·¥å‚æ¨¡å¼ (Factory Pattern)**ï¼šå°†åœ¨ 3.2 èŠ‚ç»“åˆæŠ½è±¡ç±»è®²è§£ã€‚

---

### âš ï¸ 3.1 å¸¸è§é™·é˜±ï¼šæ‹’æ”¶é¦ˆèµ  (Refused Bequest) *ğŸ”¥ å®æˆ˜å¿…å¤‡*

**ç›®æ ‡**ï¼š**è¯†åˆ«**é”™è¯¯çš„ç»§æ‰¿å…³ç³»ï¼Œé˜²æ­¢**è¿åé‡Œæ°æ›¿æ¢åŸåˆ™ (LSP)** å¯¼è‡´çš„è¿è¡Œæ—¶å¼‚å¸¸ã€‚

è¿™æ˜¯ä½¿ç”¨æŠ½è±¡ç±»æ—¶æœ€å®¹æ˜“çŠ¯çš„é€»è¾‘é”™è¯¯ï¼š**çˆ¶ç±»å¼ºè¡Œç»™äº†å­ç±»ä¸€ä¸ªå®ƒä¸éœ€è¦çš„åŠŸèƒ½**ã€‚

#### é™·é˜±ï¼šé¸µé¸Ÿä¹Ÿæ˜¯é¸Ÿï¼Ÿ

**åœºæ™¯**ï¼šä½ æœ‰ä¸€ä¸ª `AbstractBird` æŠ½è±¡ç±»ï¼Œå…¶ä¸­å®šä¹‰äº† `fly()` æ–¹æ³•ã€‚
**é—®é¢˜**ï¼šå½“ä¸šåŠ¡æ‰©å±•ï¼Œéœ€è¦åŠ å…¥ `Ostrich`ï¼ˆé¸µé¸Ÿï¼‰æ—¶ï¼Œç¾éš¾å‘ç”Ÿäº†â€”â€”é¸µé¸Ÿä¸ä¼šé£ã€‚

**âŒ é”™è¯¯ä»£ç  (LSP è¿è§„)**ï¼š

```java
abstract class AbstractBird {
    // çˆ¶ç±»å‡è®¾æ‰€æœ‰é¸Ÿéƒ½ä¼šé£
    public abstract void fly();
}

class Sparrow extends AbstractBird {
    @Override
    public void fly() { System.out.println("éº»é›€é£é£é£"); } // âœ… æ­£å¸¸
}

class Ostrich extends AbstractBird {
    @Override
    public void fly() {
        // âŒ é¸µé¸Ÿè¢«è¿«å®ç° flyï¼Œä½†å®ƒåšä¸åˆ°
        // åªèƒ½æŠ›å¼‚å¸¸ï¼Œè¿™è¿åäº† LSP åŸåˆ™ï¼
        // è°ƒç”¨è€…å¦‚æœæ‹¿åˆ° AbstractBird å¼•ç”¨ï¼Œè°ƒç”¨ fly() æ—¶ä¼šå´©æºƒ
        throw new UnsupportedOperationException("æˆ‘å¤ªèƒ–äº†ï¼Œé£ä¸åŠ¨");
    }
}

```

**ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‡ºé”™**ï¼š

```java
List<AbstractBird> birds = List.of(new Sparrow(), new Ostrich());
for (AbstractBird bird : birds) {
    bird.fly(); // ğŸ’¥ éå†åˆ°é¸µé¸Ÿæ—¶ï¼Œç¨‹åºå´©æºƒï¼
}

```

**âœ… ä¿®å¤æ–¹æ¡ˆï¼šæ¥å£éš”ç¦» (Interface Segregation)**
ä¸è¦æŠŠç‰¹æ€§å¼ºåŠ ç»™æŠ½è±¡çˆ¶ç±»ã€‚å°†"èƒ½åŠ›"æŠ½ç¦»ä¸ºæ¥å£ã€‚

```java
// 1. æŠ½è±¡çˆ¶ç±»åªä¿ç•™"é¸Ÿ"å…±æœ‰çš„ç‰¹å¾
abstract class AbstractBird {
    public abstract void eat();
}

// 2. å°†"é£"çš„èƒ½åŠ›å®šä¹‰ä¸ºæ¥å£
interface Flyable {
    void fly();
}

// 3. éº»é›€ï¼šæ—¢æ˜¯é¸Ÿï¼Œåˆèƒ½é£
class Sparrow extends AbstractBird implements Flyable {
    public void eat() { ... }
    public void fly() { ... }
}

// 4. é¸µé¸Ÿï¼šåªæ˜¯é¸Ÿï¼Œä¸å®ç° Flyable
class Ostrich extends AbstractBird {
    public void eat() { ... }
    // æ ¹æœ¬å°±æ²¡æœ‰ fly æ–¹æ³•ï¼Œç¼–è¯‘æœŸå°±èƒ½æœç»è°ƒç”¨é”™è¯¯ï¼
}

```

---

### ğŸš€ 3.2 é«˜çº§æ¨¡å¼ï¼šæŠ½è±¡å·¥å‚ (Factory Integration) *â­ è¿›é˜¶é€‰å­¦*

**ç›®æ ‡**ï¼š**ç»“åˆ**æŠ½è±¡ç±»ä¸é™æ€å·¥å‚æ–¹æ³•ï¼Œ**éšè—**å¤æ‚çš„å¯¹è±¡åˆ›å»ºé€»è¾‘ã€‚

æŠ½è±¡ç±»ä¸ä»…å¯ä»¥å®šä¹‰å¯¹è±¡çš„**è¡Œä¸º**ï¼ˆæ€ä¹ˆåšï¼‰ï¼Œè¿˜å¯ä»¥æ§åˆ¶å¯¹è±¡çš„**åˆ›å»º**ï¼ˆæ€ä¹ˆæ¥ï¼‰ã€‚JDK ä¸­çš„ `Calendar` å°±æ˜¯å…¸å‹ä¾‹å­ã€‚

**åº”ç”¨åœºæ™¯**ï¼šè§£æå™¨åº“ã€‚ç”¨æˆ·åªéœ€è¦ä¸€ä¸ª `Parser`ï¼Œä¸éœ€è¦çŸ¥é“å…·ä½“æ˜¯ `JsonParser` è¿˜æ˜¯ `XmlParser`ã€‚

**æ¨¡å¼å®ç°**ï¼š

```java
public abstract class AbstractParser {

    // 1. æŠ½è±¡è¡Œä¸ºï¼šå­ç±»è´Ÿè´£å…·ä½“çš„è§£æé€»è¾‘
    public abstract void parse(String content);

    // 2. é™æ€å·¥å‚æ–¹æ³• (Static Factory Method)
    // æ ¹æ®æ¡ä»¶è¿”å›å…·ä½“çš„å­ç±»å®ä¾‹
    // æ”¶ç›Šï¼šç”¨æˆ·ä¸éœ€è¦ new å…·ä½“ç±»ï¼Œè§£è€¦ï¼
    public static AbstractParser create(String type) {
        if ("json".equalsIgnoreCase(type)) {
            return new JsonParser();
        } else if ("xml".equalsIgnoreCase(type)) {
            return new XmlParser();
        }
        throw new IllegalArgumentException("Unknown type: " + type);
    }
}

// å…·ä½“å®ç°ï¼ˆé€šå¸¸å¯¹ç”¨æˆ·éšè—ï¼Œè®¾ä¸ºåŒ…çº§ç§æœ‰ï¼‰
class JsonParser extends AbstractParser {
    @Override
    public void parse(String content) { System.out.println("è§£æJSON: " + content); }
}

class XmlParser extends AbstractParser {
    @Override
    public void parse(String content) { System.out.println("è§£æXML: " + content); }
}

// ç”¨æˆ·è°ƒç”¨
public class Demo {
    public static void main(String[] args) {
        // ç”¨æˆ·åªè·ŸæŠ½è±¡ç±»æ‰“äº¤é“
        AbstractParser parser = AbstractParser.create("json");
        parser.parse("{data: 1}");
    }
}

```

**æ”¶ç›Šåˆ†æ**ï¼š

| ç»´åº¦ | ç›´æ¥ new å­ç±» | ä½¿ç”¨æŠ½è±¡ç±»å·¥å‚æ–¹æ³• |
| --- | --- | --- |
| **è€¦åˆåº¦** | é«˜ (ä¾èµ–å…·ä½“å­ç±») | **ä½** (åªä¾èµ–æŠ½è±¡çˆ¶ç±») |
| **æ‰©å±•æ€§** | æ”¹è°ƒç”¨å¤„ä»£ç  | åªæ”¹å·¥å‚æ–¹æ³• |

---

### ğŸ“ 3.3 å®æˆ˜æŒ‘æˆ˜ï¼šæ¨¡æ‹Ÿä»£ç è¯„å®¡

**ç›®æ ‡**ï¼š**è¯Šæ–­**å¹¶**ä¿®å¤**ä¸€æ®µå­˜åœ¨è®¾è®¡ç¼ºé™·çš„è¥é”€æŠ˜æ‰£ä»£ç ã€‚

**åœºæ™¯**ï¼šç”µå•†å¤§ä¿ƒï¼Œéœ€è¦å¤„ç†ä¸åŒçš„æŠ˜æ‰£ç­–ç•¥ï¼ˆæ»¡å‡ã€æ‰“æŠ˜ï¼‰ã€‚

**ğŸ“ å¾…è¯„å®¡ä»£ç ï¼ˆåŒ…å« 3 ä¸ªä¸»è¦é—®é¢˜ï¼‰**ï¼š

```java
/**
 * è¦æ±‚ï¼š
 * 1. ä¿è¯æŠ˜æ‰£è®¡ç®—æµç¨‹çš„ç»Ÿä¸€æ€§ï¼ˆè®¡ç®— -> è®°å½•æ—¥å¿—ï¼‰
 * 2. æ‰€æœ‰çš„æŠ˜æ‰£ç­–ç•¥å¿…é¡»æœ‰åå­—
 * 3. è¿™é‡Œçš„ä»£ç æœ‰å®‰å…¨éšæ‚£å’Œè®¾è®¡é”™è¯¯ï¼Œè¯·æŒ‡å‡ºå¹¶ä¿®å¤
 */
public abstract class AbstractDiscount {
    // [é—®é¢˜1] è¿™ç§å­—æ®µå®šä¹‰æ–¹å¼å¥½å—ï¼Ÿ
    public String discountName; 

    // [é—®é¢˜2] è¿™ä¸ªæ–¹æ³•æ²¡æœ‰ finalï¼Œå­ç±»å¯ä»¥éšæ„è¦†ç›–å¯¼è‡´ä¸è®°å½•æ—¥å¿—
    public double calculate(double originalPrice) {
        double price = doCalc(originalPrice);
        System.out.println("æ—¥å¿—: åº”ç”¨æŠ˜æ‰£ " + discountName);
        return price;
    }

    // [é—®é¢˜3] è¿™é‡Œçš„ public åˆé€‚å—ï¼Ÿ
    public abstract double doCalc(double price);
}

```

---

**è¯·æ€è€ƒä½ çš„ä¿®å¤æ–¹æ¡ˆï¼Œç„¶åå‘ä¸‹çœ‹æˆ‘çš„è¯„å®¡åé¦ˆã€‚**

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ“Š ä»£ç è¯„å®¡ä¸æ ‡å‡†ç­”æ¡ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

**âœ… åšå¾—å¥½çš„åœ°æ–¹**

* ä½¿ç”¨äº† `doCalc` è¿™ç§"é’©å­æ–¹æ³•"çš„è®¾è®¡æ€è·¯ï¼Œè¯•å›¾åˆ†ç¦»é€šç”¨é€»è¾‘å’Œå…·ä½“ç®—æ³•ã€‚

**âš ï¸ éœ€è¦æ”¹è¿›çš„åœ°æ–¹**

1. **è¿åå°è£…åŸåˆ™ (Critical)**
   * **é—®é¢˜**ï¼š`public String discountName` ç›´æ¥æš´éœ²äº†æˆå‘˜å˜é‡ã€‚
   * **åæœ**ï¼šå¤–éƒ¨ä»£ç å¯ä»¥éšæ„ä¿®æ”¹æŠ˜æ‰£åç§°ï¼Œç”šè‡³è®¾ä¸º null å¯¼è‡´ç©ºæŒ‡é’ˆã€‚
   * **ä¿®å¤**ï¼šæ”¹ä¸º `protected` æˆ– `private`ï¼Œå¹¶é€šè¿‡æ„é€ å™¨åˆå§‹åŒ–ã€‚

2. **æ¨¡æ¿æ–¹æ³•æœªé”å®š (Safety)**
   * **é—®é¢˜**ï¼š`calculate` æ–¹æ³•ä¸æ˜¯ `final` çš„ã€‚
   * **åæœ**ï¼šå­ç±»å¯èƒ½é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œç›´æ¥è¿”å›ä»·æ ¼ï¼Œä»è€Œ**ç»•è¿‡äº†æ—¥å¿—è®°å½•**ï¼Œå¯¼è‡´å®¡è®¡åŠŸèƒ½å¤±æ•ˆã€‚
   * **ä¿®å¤**ï¼šåŠ ä¸Š `final` å…³é”®å­—ã€‚

3. **æŠ½è±¡æ–¹æ³•æƒé™è¿‡å¤§ (Encapsulation)**
   * **é—®é¢˜**ï¼š`doCalc` æ˜¯ `public` çš„ã€‚
   * **åæœ**ï¼šå¤–éƒ¨å¯ä»¥ç›´æ¥è°ƒç”¨ `doCalc` è·³è¿‡æ—¥å¿—è®°å½•ã€‚å…·ä½“ç®—æ³•åº”è¯¥æ˜¯å†…éƒ¨å®ç°ç»†èŠ‚ã€‚
   * **ä¿®å¤**ï¼šæ”¹ä¸º `protected`ã€‚

**ğŸŒŸ æœ€ä¼˜è§£ (Best Practice)**

```java
public abstract class AbstractDiscount {
    
    // 1. å°è£…çŠ¶æ€ï¼šä½¿ç”¨ private + Getterï¼Œæˆ– protected
    private final String discountName;

    // å¼ºåˆ¶å­ç±»å¿…é¡»æä¾›åå­—
    public AbstractDiscount(String name) {
        this.discountName = name;
    }

    // 2. é”å®šæµç¨‹ï¼šTemplate Method åŠ  final
    public final double calculate(double originalPrice) {
        if (originalPrice < 0) throw new IllegalArgumentException("ä»·æ ¼ä¸èƒ½ä¸ºè´Ÿ");
        
        // æ ¸å¿ƒè®¡ç®—å§”æ‰˜ç»™å­ç±»
        double newPrice = doCalc(originalPrice);
        
        // å¼ºåˆ¶æ‰§è¡Œçš„å‰¯ä½œç”¨ï¼ˆæ—¥å¿—ï¼‰
        System.out.println("æ—¥å¿—: [" + discountName + "] åŸä»·:" + originalPrice + " -> ç°ä»·:" + newPrice);
        
        return newPrice;
    }

    // 3. ä¿æŠ¤ç»†èŠ‚ï¼šåªå…è®¸å­ç±»å®ç°ï¼Œä¸å…è®¸å¤–éƒ¨ç›´æ¥è°ƒç”¨
    protected abstract double doCalc(double price);
}

// ç¤ºä¾‹å®ç°
class PercentageDiscount extends AbstractDiscount {
    public PercentageDiscount() {
        super("å…«æŠ˜ä¼˜æƒ ");
    }

    @Override
    protected double doCalc(double price) {
        return price * 0.8;
    }
}

```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        
ğŸ’¡ æ€»ç»“        
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        

* **Abstract Class** = **Template (éª¨æ¶)** + **Constraint (å¥‘çº¦)**ã€‚
* å¦‚æœéœ€è¦å¤ç”¨ä»£ç ä¸”æœ‰çŠ¶æ€ï¼Œé€‰æŠ½è±¡ç±»ã€‚
* å¦‚æœåªæ˜¯å®šä¹‰è¡Œä¸ºè§„èŒƒï¼Œé€‰æ¥å£ã€‚
